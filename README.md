# SHRI Homework: CI

## 1. Команды:
- cd agent; yarn; yarn; yarn start - запустить агент с дефолтными настройками;
- cd server; yarn; yarn; yarn start - запустить сервер с дефолтными настройками;
- cd agent; yarn build-docker-image - подготовить docker образ агента (micro-ci-agent-shri);
- cd server; yarn build-docker-image - подготовить docker образ сервера (micro-ci-server-shri);

## 2. Примечания

Для работы ci необходим установленный докер в системе, так как все агенты запускают сборки в отдельных контейнерах.
При запуске агента вне докера командой `yarn start` рекомендуется указать полный путь к его рабочей дирректории через переменную окружения (AGENT_WORKDIR) или аргумент командной строки (--workdir). По умолчанию это папка ./data
При старте агентов из docker образа обязательно нужно привязать docker сокет (для старта новых контейнеров) аргументом `-v /var/run/docker.sock:/var/run/docker.sock:ro`.

## 3. Настройки

Принимаемые конфиги агента и сервера описаны в файле config/schema.js в папках agent и server соответственно.

## 4. Быстрый старт

Для быстрого старта проета можно воспользоваться командой `docker-compose up` в корне проекта. Предпологается, что уже подготовлены докер образы командой из первого пункта.